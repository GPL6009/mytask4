<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
</head>

<body>
    <form id="form2" enctype="multipart/form-data">
        <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
            <!-- <a class="navbar-brand" href="/addP/logout" style="margin-left:10%;">Logout</a> -->
            <button type="button" onclick="" id="logout" name="logout" class="navbar-brand">Logout</button>
        </nav>
        <div class="nav justify-content-center">
            <div class="card nav justify-content-center" style="width: 80rem; margin-top:7%;">
                <div class="card-body text-center">
                    <button type="button" onclick="" id="addProduct" class="form-control">Add Product</button>
                </div>
                
                <div id="dynamicbutton">

                    <div>

                    </div>
                </div>

                <table class="table table-striped table-bordered" id="sample_data">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Description</th>
                            <th>image</th>
                            <th>Price</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>

            </div>
        </div>
    </form>

    <script src="/jquery/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.2/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/additional-methods.min.js"></script>
    <script>
        //let varName = document.getElementById("two").value;
        // $('#one').click(function () {
        //     var value = $("#one").val();
        //     console.log("value:", value);
        // });


        $(document).ready(function () {
            var clicked_value = 1 ;
            load_data(clicked_value);
            if (localStorage.getItem('token')) {
            }
            else {
                alert("you have to login first..!");
                location.href = "http://localhost:8080/user/login";
            }

            //

            //
        });

        function load_data(clicked_value) {
            //alert(clicked_value);
            data = clicked_value;

            console.log("coming data:", data);
            //
            //return
            $.ajax({
                url: "http://localhost:8080/product/productDashboard",
                method: "POST",
                data: { data: data },
                dataType: "JSON",
                success: function (response) {
                    var html = '';
                    var html1 = '';
                    if (response.data.length > 0) {
                        for (var count = 0; count < response.data.length; count++) {
                            html += `
                    <tr>
                        <td>`+ response.data[count].productTitle + `</td>
                        <td>`+ response.data[count].description + `</td>
                        <td><img src="http://localhost:8080/uploads/`+ response.data[count].image + `" alt="shark" width="80" height="70"></td>
                        <td>`+ response.data[count].price + `</td>
                    </tr>
                    `;
                        }
                    }

                    if (response.count) {
                        var count = response.count;
                        console.log("total count : ", count)
                        for (var i = 1; i <= count; i++) {
                            html1 += `
                            <button type="button" onclick="load_data(this.value)" class = "" id = "`+ i + `" value="` + i + `">` + i + ` </button>
                            `;
                        }
                    }

                    $('#sample_data tbody').html(html);

                    $('#dynamicbutton div').html(html1);
                }
            });

        }
        //

        //add product
        document.getElementById("addProduct").onclick = function () {
            location.href = "http://localhost:8080/product/addProduct";
        };

        //Logout
        document.getElementById("logout").onclick = function () {
            location.href = "http://localhost:8080/user/login";
            localStorage.removeItem('token');
            //localStorage.clear();
        };

    </script>
</body>

</html>
